<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="../format.css">
</head>
<body>
<h1>Um Estudo de Redes Neurais Recorrentes no Contexto de Previsões no Mercado Financeiro</h1>

<h4>Lucas Pimenta Vasco</h4>

<p>Trabalho de conclusão do curso de graduação em engenharia de computação submetido ao corpo docente do Departamento de Computação da Universidade Federal de São Carlos como parte dos requisitos necessários para obtenção do título de engenheiro de computação.</p>

<p>São Carlos, 2020</p>

<h2 id="resumo">Resumo</h2>

<p>
Predição de séries temporais financeiras é uma das aplicações de inteligência artificial mais estudadas por pesquisadores do mercado financeiro, tanto no mundo acadêmico quanto no corporativo. 
Dentro dessa área, há um grande destaque para a predição de valores de ações, principalmente devido à possibilidade de rentabilidade. 
Uma das técnicas mais utilizadas para fazer esse tipo de predição é a aplicação de redes neurais artificiais.
Esse trabalho é focado em uma das classes de redes neurais artificiais, as redes neurais recorrentes. 
São utilizados três tipos de arquitetura dessa área: o modelo de redes neurais recorrentes simples (VRNN) o Long Short Term Memory (LSTM) e o Gated Recurrent Unit (GRU). 
Ao longo do trabalho são criados modelos de cada uma dessas arquiteturas para três ações diferentes da bolsa de valores brasileira, mais especificamente das ações do Grupo Fleury (FLRY3), da Petrobras (PETR4) e da Vale (VALE3). 
Os modelos criados para cada uma das ações fazem uma predição dos valores dessas ações, e os resultados são comparados entre si com a intenção de avaliar qual predição obtém os valores mais próximos dos valores reais. 
As medidas de erro utilizadas nesse trabalho são o erro absoluto médio e o erro quadrático médio. Ao final, concluiu-se que os modelos GRU e LSTM obtém resultados semelhantes, com um desempenho um pouco melhor do GRU, e o VRNN conseguiu detectar padrões nos dados, mas não com tanta precisão quantos os outros.
</p>

<h2 id="introducao">INTRODUÇÃO</h2>

<p>
A predição bem-sucedida de dados de séries financeiras temporais sempre foi muito visada. 

A previsão do preço de ações, algorithmic trading, precificação de ativos, alocação de portfólio, entre outras, são áreas que despertam interesse de pesquisadores e investidores, por causa da possibilidade de rentabilidade. 

Devido à natureza volátil e não linear de dados do mercado de ações, depara-se com técnicas de Aprendizado de Máquina (AM) como forma de modelar, visto que o cérebro humano possui características desejáveis em qualquer sistema artificial. 

Entre elas estão a flexibilidade para se adaptar a situações, aprender com a experiência, a capacidade para lidar com informações inconsistentes e de reconhecer e generalizar padrões. 

Sendo assim, para se alcançar boas predições, a criação de modelos de AM vem sendo amplamente explorada.

O valor de uma ação é o maior valor pelo qual alguém quer vender essa ação, ou o menor valor pelo qual alguém a quer comprar, o que faz da oferta e demanda um fator decisivo para a definição de seu preço. 

Se muitas pessoas querem comprar uma ação, seu preço aumenta devido à alta demanda, e se muitas pessoas a quiserem vender, a alta oferta faz o seu preço abaixar. 

O conceito é fácil de ser compreendido, o problema é compreender os fatores que influenciam na variação da oferta e demanda. 

Apesar de parecer ser uma tarefa muito complicada, há anos são usadas técnicas de inteligência artificial para prever o preço de ações, sendo possível encontrar exemplos até de 1994. 

Com o avanço da tecnologia nas últimas décadas, os modelos de Deep Learning (DL) vêm se destacando cada vez mais entre os modelos utilizados para esse propósito.

No contexto de predição do valor de ações, são feitos estudos com base em diversas classes de Redes Neurais Artificiais (RNA). 

Kim aplica SVM para classificar a direção do índice do mercado de ações coreano usando indicadores de análise técnica como variáveis preditivas. 

Kim e Han utilizou um algoritmo genético para discretização dos valores contínuos dos indicadores de análise técnica, com a finalidade de otimizar os pesos de uma RNA, resultando em uma melhor predição. 

Pai e Lin combinou SVM com um modelo Autoregressive Integrated Moving Average (ARIMA) em um sistema híbrido com erros menores do que os obtidos pelos modelos utilizados separadamente. 

Chen, Cheng e Tsai utiliza lógica fuzzy em uma série temporal, com o objetivo de superar limitações relativas a suposições de linearidade presentes em outros modelos, como o ARIMA. 

Porém, os modelos de DL que se mostraram mais estudados e que obtiveram melhores resultados quando comparados a outros tipos de modelo nesse contexto são os de Redes Neurais Recorrentes (RNR).

É importante também citar outros trabalhos como o de Wang, Xu e Zheng e de Iwasaki e Chen, que mostram uma abordagem inovadora, utilizando métodos de interpretação de textos relacionados a investimentos em ações retirados da internet para melhorar significativamente a previsão de seus modelos. 

Wang, Xu e Zheng inclusive propõe um novo modelo chamado de deep random ensemble, que mistura múltiplos modelos de AM e obtém resultados impressionantes.

O objetivo desse projeto é focar na predição dos valores de ações de empresas registradas na B3, a bolsa de valores brasileira utilizada para câmbio de ações, utilizando RNRs e comparar os resultados obtidos com cada modelo. 

Os três tipos de RNRs utilizados para comparação nesse trabalho são: Long Short-Term Memory (LSTM), Gated Recurrent Unit (GRU), e a RNR simples, também conhecida como Vanilla Recurrent Neural Network (VRNN).
</p>

<h2 id="motivacao">Motivação</h2>
<p>
Com o objetivo de ter o conhecimento das tendências de ações, visando um maior lucro e garantia, o interesse de investidores do mercado financeiro em métodos precisos de predição do valor de ações é muito grande. 

Conforme novas tecnologias surgem, são feitos estudos da acurácia dos diferentes tipos de modelos disponíveis, muitas vezes usando mais de uma técnica, com a finalidade de diminuir o erro dos modelos e por consequência aumentar a precisão das predições. 

Além disso, é possível utilizar outras técnicas para automatizar a compra e venda de ativos de acordo com esses modelos criados, facilitando ainda mais o processo.

Pelo interesse do autor em investimentos de ações no mercado financeiro, e com uma ampla gama de métodos disponíveis para predição dos valores futuros, esse trabalho apresentou uma oportunidade de testar algumas das técnicas de AM e validar a possibilidade do uso de modelos de RNR como uma opção viável de ser utilizada para investimento.
</p>

<h2 id="objetivos">Objetivos</h2>
<p>
Este trabalho tem como objetivo realizar um estudo sobre RNRs aplicadas ao mercado de ações, treinando modelos com 3 datasets de ações diferentes encontrados na bolsa de valores brasileira, tais como FLRY3, PETR4 e VALE3.

Para averiguar a precisão das predições, o Erro Quadrático Médio (EQM) e o Erro Absoluto Médio (EAM) de cada modelo será analisado. 

Assim, será possível concluir qual tipo RNR provê melhores resultados.

Adicionalmente, o trabalho propõe um estudo dos hiperparâmetros que podem ser modificados para esses tipos de RNA, identificando a combinação que traz o menor erro durante o teste. 

Posteriormente, os hiperparâmetros considerados como ótimo são aplicados em todos os modelos testados.
</p>

<h2 id="fundamentacao">Fundamentação teórica</h2>

<h3>Séries Temporais</h3>

<p>
Uma série temporal é uma sequência de valores de uma variável observadas ao longo do tempo. 

A ordem dos dados é fundamental e os valores vizinhos são dependentes. 

Logo, um dos interesses é analisar e modelar esta dependência.

A série temporal pode ser contínua, quando os valores são observados continuamente, ou discreta, quando os valores são observados em tempos específicos, normalmente equiespaçados. 

Essa terminologia se refere ao espaçamento dado entre as observações e não ao tipo da variável resposta.

Conceitualmente, uma série temporal com n observações possui a seguinte representação: periquito, onde periquito são valores de periquito é a série temporal e as variáveis periquito a periquito são amostras da série no período periquito.

Segundo a abordagem de componentes não observáveis, as séries temporais podem ser representadas como a combinação de quatro componentes: Tendência, Cíclica, Sazonal e Erro.

As componentes de tendência frequentemente produzem mudanças graduais em longo prazo, podendo ser de crescimento ou decrescimento. Um exemplo é o crescimento constante na população.

As componentes cíclicas são aquelas que provocam oscilações de subida e de queda nas séries, de forma suave e repetitiva, ao longo da componente de tendência. 

Geralmente os efeitos cíclicos em uma série são causados por mudanças na demanda do produto, por ciclos de negócios e, em particular, pela inabilidade de se suprir as necessidades do consumidor.

As componentes sazonais em uma série são aquelas oscilações de subida e de queda que sempre ocorrem em um determinado período do ano, do mês, da semana, do dia ou horário. 

Por exemplo, é natural esperar que as vendas mensais de brinquedos terão um pico no mês de outubro, devido ao dia das crianças. 

Este padrão possivelmente se repetirá ao longo de vários anos.

A diferença essencial entre as componentes sazonais e cíclicas é que a primeira possui movimentos facilmente previsíveis, ocorrendo em intervalos regulares de tempo. 

Já os movimentos cíclicos tendem a ser irregulares.

A quarta componente da série, chamada de erro, apresenta flutuações de período curto, com deslocamento inexplicável e geralmente são causadas, entre outros motivos, por eventos políticos, econômicos e oscilações climáticas imprevisíveis.

Os modelos de previsão podem ser classificados em univariados, os quais têm a previsão dos valores futuros explicados somente pelos valores passados da própria série ou causais, ou os que levam em conta outras informações relevantes (covariáveis) como influentes para a previsão de uma variável resposta.

Segundo Shumway e Stoffer, o principal objetivo da análise de séries temporais é desenvolver modelos matemáticos que consigam descrever uma certa amostra de dados, a fim de identificar o comportamento desses dados. 

Os modelos de previsão de séries temporais são capazes de definir, com certo grau de confiança, os valores futuros das séries a partir das observações passadas da própria série. 

O uso de modelos de previsão é importante, pois tem como caráter diminuir os riscos na tomada de decisão.
</p>

<h3>Inteligência artificial</h3>

<p>
Luger e Stubblefield definem Inteligência Artificial como o ramo da ciência da computação que trata da automação de comportamento inteligente. 

O surgimento dessa área foi um resultado natural da busca do ser humano pelo entendimento da forma como ele age e pensa. 

Com o desenvolvimento da ciência da computação e da neurociência, a IA passou a utilizar dessas duas áreas em busca da construção de entidades inteligentes.

A partir dessa definição, podemos dizer que um dos objetivos da IA, quando olhamos no contexto de Aprendizado de Máquina, é de construir e compreender inteligência, criando algo inteligente o suficiente para ter a capacidade de analisar dados e reconhecer padrões. 

Isto significa que, através da IA, é possível criar métodos preditivos analíticos, que serão melhor explorados no decorrer deste trabalho.

Os princípios da IA podem ser encontrados no trabalho de Turing, que propõe o chamado teste de Turing. 

O teste foi uma proposta para verificar o nível de inteligência de uma máquina, em que, caso o entrevistador humano não consiga diferenciar se o objeto entrevistado é uma máquina ou outro ser humano, essa máquina pode ser considerada inteligente. 

Segundo Russell e Norvig, para uma máquina ser considerada aprovada no teste, ela precisa ter as seguintes competências:

Processamento de linguagem natural, para possibilitar a comunicação; 

Representação de conhecimento, para armazenar o que ela aprende ou vê; 

Raciocínio automatizado, para usar a informação armazenada para responder perguntas e tirar novas conclusões; 
Aprendizado de máquina, adaptar a novas circunstâncias e detectar e extrapolar padrões.

Além dessas quatro competências, o chamado teste de Turing total, uma versão aprimorada, acrescenta ainda mais dois pontos:

Visão computacional, para compreender objetos;

Robótica, para manipular objetos e conseguir se movimentar.
Essas seis grandes áreas compreendem a maioria dos estudos e pesquisas de IA, fazendo o teste de Turing continuar sendo relevante mesmo décadas depois de ter sido proposto.
Nesse contexto, com o avanço da tecnologia, a capacidade computacional torna-se suficiente para grandes aplicações envolvendo Aprendizado de Máquina, que é um sub-área de Inteligência Artificial que usa algoritmos de aprendizado para construir sistemas que têm a capacidade de aprender e melhorar automaticamente com as experiências sem serem programados explicitamente.
No Aprendizado de Máquina, treinamos o algoritmo fornecendo-lhe muitos dados e permitindo que ele aprenda mais sobre as informações processadas. Conforme avançamos para a era do Big Data, temos um volume enorme de dados disponível para treinar essas aplicações. Visto que a capacidade humana de processamento de grandes volumes de dados parece limitada diante do potencial desses sistemas automatizados, eles podem trazem consigo a capacidade de remodelar a sociedade e a forma como ela trabalha, principalmente se tratando de situações específicas em que os algoritmos podem se especializar.
Ainda nessa linha, tem-se o conceito de Deep Learning, que procura imitar o cérebro humano e que pode ser definido como uma arquitetura de rede multi neural contendo um grande número de parâmetros e camadas. 
Na figura Figura 1 é possível ver o diagrama de Venn que elucida a composição de Inteligência Artificial, Aprendizado de Máquina e Deep Learning.
</p>

</body>
</html>